<!-- ----------------------------------------------------------
     Author: Nandan Kumar
     Assignment 13: Base Template
     File: templates/base.html

     Description:
     Global layout for all UI pages (navbar, theme, structure).
     Navbar updates based on user authentication state using
     localStorage (client-side only).
----------------------------------------------------------- -->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>
        {% if title %} {{ title }} — Calculations App {% else %} Calculations App {% endif %}
    </title>

    <link rel="stylesheet" href="/static/css/style.css" />
    <script src="/static/js/script.js"></script>
</head>

<body>

    <!-- NAVIGATION BAR -->
    <nav class="navbar">
        <div class="nav-title">Calculations App</div>

        <div class="nav-links" id="navLinks">
            <!-- Default: Show Home/Login/Register -->
            <a href="/">Home</a>
            <a href="/login">Login</a>
            <a href="/register">Register</a>
        </div>
    </nav>

    <div class="page-container">
        {% block content %}{% endblock %}
    </div>

    <!-- Navbar Login State Control -->
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const token = localStorage.getItem("access_token");
            const username = localStorage.getItem("username");
            const nav = document.getElementById("navLinks");

            if (token && username) {
                // User is logged in → Show dashboard + logout
                nav.innerHTML = `
                    <span style="margin-right: 16px;">
                        Welcome, <strong>${username}</strong>
                    </span>
                    <a href="/dashboard">Dashboard</a>
                    <a href="#" onclick="logoutUser()">Logout</a>
                `;
            } else {
                // User NOT logged in → Show home/login/register
                nav.innerHTML = `
                    <a href="/">Home</a>
                    <a href="/login">Login</a>
                    <a href="/register">Register</a>
                `;
            }
        });
    </script>

</body>

</html>